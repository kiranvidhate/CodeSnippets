<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5.2" />
  </startup>
  <appSettings>
    <add key="log4net.Internal.Debug" value="true"/>
  </appSettings>
  <system.diagnostics>
    <trace autoflush="true">
      <listeners>
        <add
            name="textWriterTraceListener"
            type="System.Diagnostics.TextWriterTraceListener"
            initializeData="log4net.txt" />
      </listeners>
    </trace>
  </system.diagnostics>

  <configSections>
    <section name="log4net"
           type="log4net.Config.Log4NetConfigurationSectionHandler,
         log4net" />
  </configSections>

  <log4net>
    <appender name="LogFileAppender"
                    type="log4net.Appender.RollingFileAppender" >
      <param name="File" value="log.txt" />
      <param name="AppendToFile" value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="2" />
      <maximumFileSize value="10MB" />
      <staticLogFileName value="true" />
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern"
             value="%-5p%d{yyyy-MM-dd hh:mm:ss} – %m%n" />
        <conversionPattern
             value="%newline%newline%date %newline%logger 
                       [%property{NDC}] %newline>> %message%newline" />
      </layout>
    </appender>


    <!-- Appender Logs Errors to Database-->
    <appender name="DatabaseAppender" type="log4net.Appender.ADONetAppender">
      <bufferSize value="1" />
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      <connectionString value="Server=MACHINE-204\SQLEXPRESS;Initial Catalog=Log4NetCustom;User id=sa;Password=aressindia" />
      <commandText value="INSERT INTO tblLogs ([Module], [DateTime], [Status], [Message], [UserId], [IPAddress]) VALUES ( @Module, CONVERT(datetime, @DateTime), @Status, @Message, CONVERT(INT, @UserId), @IPAddress)" />
      <parameter>
        <parameterName value="@Module" />
        <dbType value="String" />
        <size value="1000" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{module}" />
        </layout>
      </parameter>

     <parameter>
        <parameterName value="@DateTime" />
        <dbType value="String" />
       <size value="1000" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{datetime}" />
        </layout>
      </parameter>
      
      <parameter>
        <parameterName value="@Status" />
        <dbType value="String" />
        <size value="100" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{status}" />
        </layout>
      </parameter>

      <parameter>
        <parameterName value="@Message" />
        <dbType value="String" />
        <size value="1000" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{message}" />
        </layout>
      </parameter>

      <parameter>
        <parameterName value="@UserId" />
        <dbType value="String" />
        <size value="100" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{userid}" />
        </layout>
      </parameter>

      <parameter>
        <parameterName value="@IPAddress" />
        <dbType value="String" />
        <size value="500" />
        <layout type="WPFLog4Net.ActionLayoutPattern">
          <conversionPattern value="%actionInfo{ipaddress}" />
        </layout>
      </parameter>
    </appender>

    <root>
      <level value="ALL" />
      <appender-ref ref="DatabaseAppender" />
      <!--<appender-ref ref="LogFileAppender" />-->
    </root>
  </log4net>

</configuration>